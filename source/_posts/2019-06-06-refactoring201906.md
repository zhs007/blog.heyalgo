title: 2019年5月工作总结
date: 2019-06-06 16:32:50
tags:
---

## Golang升级到1.12

用``go module``替换了``dep``，项目终于可以不用放``gopath``里了。  
有个小问题，就是目前没有发现go module能用非tag的方式精确定位版本，以前dep可以定位branch的，所以接下来可能一段时间tag会多一点。

## 可以通过配置文件开启pprof

新增配置pprof，需要在jarvisnode.yaml文件里加入配置，即可开启

``` yaml
# pprof - pprof
pprof:
  baseurl: ':6061'
```

如果是docker启动的，还需要端口映射。  
可以通过浏览器来看到数据，也可以用to tools来进一步分析，我一般生成svg图片，会看得清楚一些。

``` bash
go tool pprof http://127.0.0.1:6061/debug/pprof/heap

go tool pprof http://127.0.0.1:6061/debug/pprof/goroutine
```

## 增加了随机密码插件

增加了随机密码插件。  

``` bash
generatepassword -m normal -l 16
```

这个后面要能直接添加tag，能直接查密码就好了。  

## 重启节点

前几天加了个不更新但可以重启节点的命令

``` bash
updnodes -t jarvisshell -r=true
```

## 订阅新闻

```
subscribearticles -t 300 -w=huxiu -w=tmtpost -w=36kr
```

## duckling插件

加入了duckling的plugin，可以先测一下duckling解析。  
还是加了duckling的配置文件，以及需要修改config.yaml，开启duckling插件。

```
duckling -l zh_CN -t "这个星期四要去看复联"
duckling -l en_GB -t "I am going to see the movie this Thursday."
```

## 新的日志模块

- stdout和stderr单独获取并保存。  
- 可以通过指令清理日志。
- 节点日志和script日志统一

## App Market（未最终完成）

用来替换以前的script的，支持多仓库。